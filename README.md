# RTMQTT - Python MQTT apps for the Raspberry Pi

### Introduction

This repo includes a couple of apps that can be used with a Raspberry Pi and MQTT to stream environmental sensor and video data:

    * PiSensorMQTT - this MQTT client app runs on a Raspberry Pi and supports a range of environmental sensors. If a Pi camera is present, it will also stream MJPEG video using the Pi camera.
    * VideoViewMQTT - this MQTT client app is a simple way of displaying the video stream generated by PiSensorMQTT.
    
### Supported sensors

Supported sensors include:

    * ADXL345 acceleration sensor.
    * BMP180 pressure/temperature sensor.
    * HTU21D humidity/temperature sensor.
    * MCP9808 temperature sensor.
    * TMP102 temperature sensor.
    * TSL2651 light sensor.
    
Any combination of these sensors can be used - check PiSensorMQTT.py for information on how to customize the sensor set.

### Raspberry Pi Installation

Prepare the system by installing the pre-requisites:

	sudo apt-get install git python-dev python-pip python-smbus

The MQTT Python client can be installed using pip:

    sudo pip install --upgrade pip
    sudo pip install paho-mqtt
    
Then clone the repo and run the script:

    git clone git://github.com/richards-tech/RTMQTT.git
    cd RTMQTT/PiSensorMQTT
    python PiSensorMQTT.py -b broker_address -i sample_interval
    
broker_address defaults to localhost and is the address of the MQTT broker to use. sample_interval defaults to 0.1 seconds (10 samples per second). To get more information on command line options, enter:

    python PiSensorMQTT.py -h

### Desktop installation

Prepare the system by installing the pre-requisites:

	sudo apt-get install python-dev python-pip python-pygame mosquitto-clients
	
To get an MQTT broker running on the desktop:

    sudo apt-get install mosquitto
    
### Displaying the video stream

VideoViewMQTT will display the video stream if the Raspberry Pi has a Pi camera. Clone the repo and run the script:

    git clone git://github.com/richards-tech/RTMQTT.git
    cd RTMQTT/VideoViewMQTT
    python VideoViewMQTT.py -b broker_address
    
If using a broker running on the same machine then the -b option can be omitted. To get more information on command line options, enter:

    python VideoViewMQTT.py -h

### Displaying the sensor stream

To display the sensor information, enter:

    mosquitto_sub -t pisensor/sensors -h broker_address
    
This will display the JSON record containing the sensor readings. For example:

    {"timestamp": 1450800005.019396, "pressure": 1245.11, "humidity": 33.531707763671875, "temperature": 22.6, "light": 177.61121911647876}
    








